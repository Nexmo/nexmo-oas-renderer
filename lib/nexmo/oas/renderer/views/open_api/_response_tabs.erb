<%
  tabs = Nexmo::OAS::Renderer::Presenters::ResponseTabs.new(format, response, content, endpoint, theme_light: @theme_light)

  switcher = Nexmo::OAS::Renderer::Presenters::ContentSwitcher.new(label: "Response Example", format: format, force_type: tabs.switcher, theme_light: @theme_light)

  tabs.tab_links.each_with_index do |v,k|
    switcher.add_content(
      title: v.content,
      content: (erb *tabs.tab_panels[k].content),
      tab_id: v.data_tab_link,
      active: k == 0
    )
  end
%>

<%= erb *switcher.render %>

<%
  # If there are any examples, show them
  examples = response.raw['content'][format]['examples']
  if content == :responses && format == "application/json" && examples
    example_switcher = Nexmo::OAS::Renderer::Presenters::ContentSwitcher.new(label: "Response Example", format: format, force_type: 'dropdown', theme_light: @theme_light)

    examples.each_with_index do |v,k|
      response = JSON.neat_generate(v[1], {
                      wrap: true,
                      after_colon: 1,
                  })

      content = <<~HEREDOC
        <pre class="pre-wrap language-json #{@theme_light ? 'Vlt-prism--dark' : ''} Vlt-prism--copy-disabled"><code>#{response}</code></pre>
      HEREDOC


      example_switcher.add_content(
        title: v[0].titleize,
        content: content,
        tab_id: v[0],
        active: k == 0
      )
    end
  end
%>

<%= erb *example_switcher.render if example_switcher %>
